webpackJsonp([8],{"+sVX":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("BO1k"),s=i.n(n),a=i("KRg4"),r=(a.a,Boolean,String,String,String,Array,Boolean,String,String,Boolean,{name:"search",mixins:[a.a],props:{required:{type:Boolean,default:!1},placeholder:String,cancelText:String,value:{type:String,default:""},results:{type:Array,default:function(){return[]}},autoFixed:{type:Boolean,default:!0},top:{type:String,default:"0px"},position:{type:String,default:"fixed"},autoScrollToTop:Boolean},created:function(){this.value&&(this.currentValue=this.value)},computed:{fixPosition:function(){return this.isFixed?"absolute"===this.position?"absolute":"fixed":"static"}},methods:{emitEvent:function(){var t=this;this.$nextTick(function(){t.$emit("input",t.currentValue),t.$emit("on-change",t.currentValue)})},onComposition:function(t,e){"start"===e&&(this.onInput=!0),"end"===e&&(this.onInput=!1,this.emitEvent()),"input"===e&&(this.onInput||this.emitEvent())},clear:function(){this.currentValue="",this.emitEvent(),this.isFocus=!0,this.setFocus(),this.autoFixed&&!this.isFixed&&(this.isFixed=!0)},cancel:function(){this.isCancel=!0,this.currentValue="",this.emitEvent(),this.isFixed=!1,this.$emit("on-cancel")},handleResultClick:function(t){this.$emit("result-click",t),this.$emit("on-result-click",t),this.isCancel=!0,this.isFixed=!1},touch:function(){this.isCancel=!1,this.autoFixed&&(this.isFixed=!0),this.$emit("on-touch")},setFocus:function(){this.$refs.input.focus()},setBlur:function(){this.$refs.input.blur()},onFocus:function(){this.isFocus=!0,this.$emit("on-focus"),this.touch()},onBlur:function(){this.isFocus=!1,this.$emit("on-blur")}},data:function(){return{onInput:!1,currentValue:"",isCancel:!0,isFocus:!1,isFixed:!1}},watch:{isFixed:function(t){!0===t&&(this.setFocus(),this.isFocus=!0,this.autoScrollToTop&&setTimeout(function(){window.scrollTo(0,0)},150))},value:function(t){this.currentValue=t}}}),o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vux-search-box",class:{"vux-search-fixed":t.isFixed},style:{top:t.isFixed?t.top:"",position:t.fixPosition}},[i("div",{staticClass:"weui-search-bar",class:{"weui-search-bar_focusing":!t.isCancel||t.currentValue}},[t._t("left"),t._v(" "),i("form",{staticClass:"weui-search-bar__form",attrs:{action:"."},on:{submit:function(e){e.preventDefault(),t.$emit("on-submit",t.value)}}},[i("label",{directives:[{name:"show",rawName:"v-show",value:!t.isFixed&&t.autoFixed,expression:"!isFixed && autoFixed"}],staticClass:"vux-search-mask",attrs:{for:"search_input_"+t.uuid},on:{click:t.touch}}),t._v(" "),i("div",{staticClass:"weui-search-bar__box"},[i("i",{staticClass:"weui-icon-search"}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],ref:"input",staticClass:"weui-search-bar__input",attrs:{type:"search",autocomplete:"off",id:"search_input_"+t.uuid,placeholder:t.placeholder,required:t.required},domProps:{value:t.currentValue},on:{focus:t.onFocus,blur:t.onBlur,compositionstart:function(e){t.onComposition(e,"start")},compositionend:function(e){t.onComposition(e,"end")},input:[function(e){e.target.composing||(t.currentValue=e.target.value)},function(e){t.onComposition(e,"input")}]}}),t._v(" "),i("a",{directives:[{name:"show",rawName:"v-show",value:t.currentValue,expression:"currentValue"}],staticClass:"weui-icon-clear",attrs:{href:"javascript:"},on:{click:t.clear}})]),t._v(" "),i("label",{directives:[{name:"show",rawName:"v-show",value:!t.isFocus&&!t.value,expression:"!isFocus && !value"}],staticClass:"weui-search-bar__label",attrs:{for:"search_input_"+t.uuid}},[i("i",{staticClass:"weui-icon-search"}),t._v(" "),i("span",[t._v(t._s(t.placeholder||"搜索"))])])]),t._v(" "),i("a",{staticClass:"weui-search-bar__cancel-btn",attrs:{href:"javascript:"},on:{click:t.cancel}},[t._v(t._s(t.cancelText||"取消")+"\n    ")]),t._v(" "),t._t("right")],2),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isFixed,expression:"isFixed"}],staticClass:"weui-cells vux-search_show"},[t._t("default"),t._v(" "),t._l(t.results,function(e){return i("div",{staticClass:"weui-cell weui-cell_access",on:{click:function(i){t.handleResultClick(e)}}},[i("div",{staticClass:"weui-cell__bd weui-cell_primary"},[i("p",[t._v(t._s(e.title))])])])})],2)])},staticRenderFns:[]};var c=i("VU/8")(r,o,!1,function(t){i("ul0X")},null,null).exports,u=i("rHil"),l=(i("rLAy"),i("mtWM")),d=i.n(l),h=(u.a,function(t){function e(e){return t.apply(this,arguments)}e.toString=function(){return t.toString()}}(function(t){console.log("on-change",t),this.results=t?getResult(this.value):[]}),{data:function(){return{name:window.localStorage.getItem("userName"),results:[],value:"",friend:{},userId:window.localStorage.getItem("userId")||""}},components:{Search:c,Group:u.a},methods:{getResult:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){console.log("on-change",t),this.results=t?getResult(this.value):[]}),onSubmit:function(){this.$refs.search.setBlur()},onFocus:function(){console.log("on focus")},searchPerson:function(){var t=this;if(!/^1[3|4|5|7|8][0-9]{9}$/.test(this.value))return this.$vux.toast.show({type:"cancel",text:"手机格式不正确"}),0;d.a.post("http://121.42.177.97:8080/red/user/findfriend.do?name="+this.value).then(function(e){console.log(e.data),"查不到该联系人"===e.data.message?t.$vux.toast.show({type:"cancel",text:"查不到该联系人"}):(t.friend=e.data.data,window.localStorage.setItem("friendName",e.data.data.user_name),window.localStorage.setItem("userId",e.data.data.user_id),window.localStorage.setItem("nickName",e.data.data.nick_name),t.$router.push({name:"userDetails",params:{id:e.data.data.user_id}}))}).catch(function(t){throw t})}}}),f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("search",{ref:"search",attrs:{results:t.results,position:"absolute","auto-scroll-to-top":"",top:"0",placeholder:"手机号搜索"},on:{"on-focus":t.onFocus,"on-submit":t.onSubmit},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[i("group",[""!==t.value?i("p",{on:{click:t.searchPerson}},[i("i",{staticClass:"iconfont icon-sousuo"}),t._v("搜索："),i("span",[t._v(t._s(t.value))])]):t._e()])],1)],1)},staticRenderFns:[]};var v=i("VU/8")(h,f,!1,function(t){i("slpw")},"data-v-5d6f414c",null).exports,_={data:function(){return{pageName:"人脉",name:window.localStorage.getItem("userName"),friends:[],friendReq:!1,myId:window.localStorage.getItem("myId"),addFriend:[],friendInfos:[],myAdd:[]}},mounted:function(){var t=this;d.a.get("http://121.42.177.97:8080/red/user/find_people.do?user_id="+this.myId).then(function(e){console.log(e.data);var i=!0,n=!1,a=void 0;try{for(var r,o=s()(e.data.data);!(i=(r=o.next()).done);i=!0){var c=r.value;t.addFriend.push(c.user_id)}}catch(t){n=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}0!==e.data.data.length&&(t.friendReq=!0,t.getFriendInfo())}).catch(function(t){throw t}),d.a.get("http://121.42.177.97:8080/red/user/no_friend.do?user_id="+this.myId).then(function(e){t.myAdd=e.data.data}).catch(function(t){throw t})},components:{searchInfo:v},methods:{getFriendInfo:function(t){var e=this,i=!0,n=!1,a=void 0;try{for(var r,o=s()(this.addFriend);!(i=(r=o.next()).done);i=!0){var c=r.value;d.a.get("http://121.42.177.97:8080/red/user/find_id.do?friend_id="+c).then(function(t){e.friendInfos.push(t.data.data[0]),0!==t.data.data.length&&(e.friendReq=!0)}).catch(function(t){throw t})}}catch(t){n=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}},accept:function(t){var e=this;d.a.get("http://121.42.177.97:8080/red/user/add_me_friend.do?user_id="+this.myId+"&friend_id="+t).then(function(t){"不能这样添加好友"===t.data.data?window.localStorage.setItem("acceptbtn",e.acceptbtn):e.$router.push({path:"/contact"})}).catch(function(t){throw t})}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"new-friends"}},[n("header",{attrs:{id:"header-title"}},[n("router-link",{staticClass:"iconfont icon-fanhui",attrs:{to:"/contact"}}),t._v(" "),n("span",[t._v("添加好友")])],1),t._v(" "),n("div",{staticClass:"person-search"},[n("search-info")],1),t._v(" "),n("div",{staticClass:"weui-cells__title initial"},[t._v("新的朋友")]),t._v(" "),t._l(t.friendInfos,function(e){return t.friendReq?n("div",{key:e.friend_id,staticClass:"weui-cells"},[n("router-link",{staticClass:"weui-cell",attrs:{to:{name:"userDetails",params:{id:e.friend_id}}}},[n("div",{staticClass:"weui-cell__hd"},[n("img",{attrs:{src:i("c5Or"),alt:""}})]),t._v(" "),n("div",{staticClass:"weui-cell__bd"},[n("h5",[t._v(t._s(e.nick_name))]),t._v(" "),n("p",[t._v("我是"+t._s(e.friend_name))])]),t._v(" "),n("div",{staticClass:"weui-cell__ft"},[n("a",{staticClass:"weui-btn weui-btn_mini weui-btn_primary",on:{click:function(i){t.accept(e.friend_id)}}},[t._v("接受")])])])],1):t._e()}),t._v(" "),n("div",{staticClass:"weui-cells"},t._l(t.myAdd,function(e){return n("div",{key:e.friend_id,staticClass:"weui-cell"},[t._m(0,!0),t._v(" "),n("div",{staticClass:"weui-cell__bd"},[n("h5",[t._v(t._s(e.friend_nick))]),t._v(" "),n("p",[t._v("我是"+t._s(e.friend_id))])]),t._v(" "),t._m(1,!0)])}))],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__hd"},[e("img",{attrs:{src:i("c5Or"),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__ft"},[e("span",[this._v("我添加的好友")])])}]};var m=i("VU/8")(_,p,!1,function(t){i("iIyQ")},"data-v-0d026b6a",null);e.default=m.exports},iIyQ:function(t,e){},slpw:function(t,e){},ul0X:function(t,e){}});
//# sourceMappingURL=8.8d95aefbbbb87423e5ce.js.map