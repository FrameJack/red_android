webpackJsonp([11],{"4X6D":function(t,e){},GLPJ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("BO1k"),i=s.n(a),n=s("mtWM"),o=s.n(n),d=s("r3Tl"),r=s("A2Dw"),c=s("KGIi"),l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"red"}},[e("ul",[e("li",{staticClass:"list-item"},[e("router-link",{staticClass:"list-item-content",attrs:{to:"/message/grap"}},[e("div",{staticClass:"msg-list-content"},[e("div",{staticClass:"msg-header"},[e("div",{staticClass:"header-box"},[e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-qianghongbao"}})])])]),this._v(" "),e("div",{staticClass:"msg-content"},[e("h3",[this._v("抢红包")])])])])],1),this._v(" "),e("li",{staticClass:"list-item"},[e("router-link",{staticClass:"list-item-content",attrs:{to:"/message/give"}},[e("div",{staticClass:"msg-list-content"},[e("div",{staticClass:"msg-header"},[e("div",{staticClass:"header-box"},[e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-fahongbao"}})])])]),this._v(" "),e("div",{staticClass:"msg-content"},[e("h3",[this._v("发红包")])])])])],1)])])},staticRenderFns:[]};var u=s("VU/8")(null,l,!1,function(t){s("4X6D")},"data-v-cdce8d14",null).exports,g=(d.a,r.default,{data:function(){var t=window.localStorage.getItem("uid"),e=window.localStorage.getItem("userName"),s=window.localStorage.getItem("myId"),a=window.localStorage.getItem("chatId"),i=window.localStorage.getItem("friendTouid"),n=window.localStorage.getItem("friendNick");return{userName:e,msgsCont:"",msgsNum:Number,uid:t,hasMessages:!1,myId:s,list:[],friendIds:[],chatId:a,friendTouid:i,chatName:"",hasHead:!1,headUrl:"",hasPic:!1,friendNick:n}},created:function(){var t=this;null!==this.chatId&&o.a.get("http://121.42.177.97:8080/red/use/pic_id.do?user_id="+this.chatId).then(function(e){console.log("有图"),t.hasPic=!0}).catch(function(t){throw t}),o.a.post("http://121.42.177.97:8080/red/user/allfriend.do?name="+this.userName).then(function(e){console.log(e.data.data),t.list=e.data.data;var s=!0,a=!1,n=void 0;try{for(var o,d=i()(e.data.data);!(s=(o=d.next()).done);s=!0){var r=o.value;t.friendIds.push(r.friend_id.toString())}}catch(t){a=!0,n=t}finally{try{!s&&d.return&&d.return()}finally{if(a)throw n}}console.log("好友ID："+t.friendIds),t.getChatName()}).catch(function(t){throw t})},mounted:function(){},components:{TopHeader:d.a,Search:r.default,grapRed:u},methods:{allHistory:function(){window.aliLogined?(console.log("阿里登录成功！"),e()):Object(c.a)(e);var t=this;function e(){t.getHistory(),t.noReadMsg()}},getHistory:function(){var t=this,e="",s=t.friendTouid;sdk.Chat.getHistory({touid:s,nextkey:e,count:10,success:function(s){e=s.data&&s.data.next_key;t.hasMessages;0!==s.data.length?(!0,t.msgsCont=s.data.msgs[0].msg,console.log(t.msgsCont)):console.log("没有消息")},error:function(t){console.log("get history msg fail",t)}})},noReadMsg:function(){var t=this;sdk.Base.getUnreadMsgCount({count:10,success:function(e){console.log("get unread msg count success",e);t.msgsNum;t.msgsNum=e.data.length},error:function(t){console.log("get unread msg count fail",t)}})},getChatName:function(){var t=this;null!==this.chatId&&o.a.get("http://121.42.177.97:8080/red/user/friend_nick.do?user_id="+this.myId+"&friend_id="+this.chatId).then(function(e){t.chatName=e.data.data[0].friend_nick}).catch(function(t){throw t})}}}),h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"message"}},[s("top-header",{attrs:{pageName:"消息"}}),t._v(" "),s("grap-red"),t._v(" "),s("div",{attrs:{id:"msg-list"}},[null===t.chatId?s("div"):s("ul",t._l(t.list,function(e){return s("li",{staticClass:"list-item"},[s("router-link",{staticClass:"list-item-content",attrs:{to:{name:"dialogue",params:{id:e.user_id}}}},[s("div",{staticClass:"msg-list-content"},[s("div",{staticClass:"msg-header"},[s("div",{staticClass:"header-box"},[t.hasPic?s("img",{attrs:{src:"http://121.42.177.97:8080/red/use/pic_id.do?user_id="+e.user_id,alt:"头像"}}):t._e()])]),t._v(" "),s("div",{staticClass:"msg-content"},[s("h5",[t._v(t._s(e.friend_nick))]),t._v(" "),s("p",[t._v(t._s(t.msgsCont))])]),t._v(" "),s("span",{staticClass:"shield iconfont icon-mute"})])])],1)}))])],1)},staticRenderFns:[]};var m=s("VU/8")(g,h,!1,function(t){s("XkDI")},"data-v-20d97382",null);e.default=m.exports},KGIi:function(t,e,s){"use strict";e.a=function(t){var e=window.localStorage.getItem("uid"),s=window.localStorage.getItem("appkey"),a=window.localStorage.getItem("credential");(window.sdk||(window.sdk=new WSDK)).Base.login({uid:e,appkey:s,credential:a,timeout:5e3,success:function(t){console.log("login success",t),window.aliLogined=!0,console.log(window.aliLogined)},error:function(t){console.log("login fail",t)}})}},XkDI:function(t,e){}});
//# sourceMappingURL=11.8b9ee9aa9dfdffd0694a.js.map